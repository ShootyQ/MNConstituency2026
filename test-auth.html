<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Firebase Auth</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        .error { color: red; background: #fee; padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { color: green; background: #efe; padding: 10px; margin: 10px 0; border-radius: 5px; }
        .info { color: blue; background: #eef; padding: 10px; margin: 10px 0; border-radius: 5px; }
        button { padding: 10px 20px; margin: 10px 0; cursor: pointer; }
        pre { background: #f5f5f5; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>Firebase Authentication Test</h1>
    <div id="status"></div>
    <button id="testSignIn">Test Google Sign In</button>
    <div id="output"></div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, signInWithPopup, GoogleAuthProvider } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { firebaseConfig } from './firebaseConfig.js';

        const status = document.getElementById('status');
        const output = document.getElementById('output');
        const testSignInBtn = document.getElementById('testSignIn');

        // Test Firebase initialization
        try {
            const app = initializeApp(firebaseConfig);
            status.innerHTML = '<div class="success">✓ Firebase initialized successfully</div>';
            status.innerHTML += `<div class="info">Config: <pre>${JSON.stringify(firebaseConfig, null, 2)}</pre></div>`;
        } catch (error) {
            status.innerHTML = `<div class="error">✗ Firebase initialization failed: ${error.message}</div>`;
            console.error('Init error:', error);
        }

        // Test Google Sign-In
        testSignInBtn.addEventListener('click', async () => {
            output.innerHTML = '<div class="info">Attempting Google Sign In...</div>';
            
            try {
                const auth = getAuth();
                const provider = new GoogleAuthProvider();
                
                output.innerHTML += '<div class="info">Opening Google popup...</div>';
                
                const result = await signInWithPopup(auth, provider);
                const user = result.user;
                
                output.innerHTML = `<div class="success">✓ Sign in successful!</div>`;
                output.innerHTML += `<div class="info">User: ${user.displayName} (${user.email})</div>`;
                output.innerHTML += `<div class="info"><pre>${JSON.stringify({
                    uid: user.uid,
                    email: user.email,
                    displayName: user.displayName,
                    photoURL: user.photoURL
                }, null, 2)}</pre></div>`;
                
            } catch (error) {
                output.innerHTML = `<div class="error">✗ Sign in failed: ${error.code}</div>`;
                output.innerHTML += `<div class="error">Message: ${error.message}</div>`;
                output.innerHTML += `<div class="info"><pre>${JSON.stringify(error, null, 2)}</pre></div>`;
                console.error('Sign in error:', error);
            }
        });
    </script>
</body>
</html>
